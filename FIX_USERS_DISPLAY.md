# โ๏ธ ุฎุทูุงุช ุฅุตูุงุญ ุนุฏู ุธููุฑ ุงููุณุชุฎุฏููู

## ุงููุดููุฉ

ุงููุณุชุฎุฏููู ูุง ูุธูุฑูู ูู ุตูุญุฉ `/dashboard/admin/users` ุจุณุจุจ:

1. ุงููุณุชุฎุฏููู ููุฌูุฏูู ูู `auth.users` ููุท
2. ูุญุชุงุฌ ููุชุงุญ Service Role ูููุตูู ุงููุงูู

---

## โ ุงูุญู ุงููุงูู (ุฎุทูุชุงู ููุท)

### ๐ ุงูุฎุทูุฉ 1: ุฅุถุงูุฉ Service Role Key

1. **ุงูุชุญ Supabase Dashboard:**
   - ุงุฐูุจ ุฅูู: https://app.supabase.com
   - ุงุฎุชุฑ ูุดุฑูุนู

2. **ุงุญุตู ุนูู Service Role Key:**
   - ุงุฐูุจ ุฅูู **Settings** โ **API**
   - ุงุจุญุซ ุนู ูุณู **Project API keys**
   - ุงูุณุฎ ููุชุงุญ **`service_role`** (โ๏ธ ูุฎูู - ุงุถุบุท ุนูู ุฃููููุฉ ุงูุนูู)

3. **ุฃุถูู ุฅูู `.env.local`:**

   ุงูุชุญ ููู `.env.local` ูู ุงููุฌูุฏ ุงูุฑุฆูุณู ูุฃุถู:

   ```bash
   SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5c... (ุงูููุชุงุญ ุงูุทููู)
   ```

4. **ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู:**
   ```bash
   # ุงุถุบุท Ctrl+C ูุฅููุงู ุงูุณูุฑูุฑ
   npm run dev
   ```

---

### ๐๏ธ ุงูุฎุทูุฉ 2: ูุฒุงููุฉ ุงููุณุชุฎุฏููู ุงูููุฌูุฏูู

1. **ุงูุชุญ SQL Editor ูู Supabase:**
   - ูู ููุญุฉ ุงูุชุญููุ ุงุฐูุจ ุฅูู **SQL Editor**
   - ุงุถุบุท **New Query**

2. **ูููุฐ ูุฐุง ุงูููุฏ:**

   ```sql
   -- ูุฒุงููุฉ ุงููุณุชุฎุฏููู ูู auth.users ุฅูู public.users
   INSERT INTO public.users (id, email, name, user_type, created_at, updated_at)
   SELECT
       au.id,
       au.email,
       COALESCE(au.raw_user_meta_data->>'name', au.email),
       COALESCE(au.raw_user_meta_data->>'user_type', 'student'),
       au.created_at,
       au.updated_at
   FROM auth.users au
   WHERE NOT EXISTS (
       SELECT 1 FROM public.users pu WHERE pu.id = au.id
   );
   ```

3. **ุงุถุบุท Run** (ุฃู `Ctrl + Enter`)

---

## ๐ ุชุญูู ูู ุงููุฌุงุญ

1. ุงูุชุญ: https://medad-system.vercel.app/dashboard/admin/users
2. ูุฌุจ ุฃู ุชุธูุฑ ุฌููุน ุงููุณุชุฎุฏููู ุงูุขู! โ

---

## ๐ ูุนูููุงุช ูููุฉ

### ูุง ูู Service Role Keyุ

- ููุชุงุญ ุฎุงุต ูููุตูู ุงููุงูู ููุงุนุฏุฉ ุงูุจูุงูุงุช (Admin access)
- ูุชุฌุงูุฒ ุณูุงุณุงุช ุงูุฃูุงู (RLS)
- **ูุฌุจ ุนุฏู ูุดุงุฑูุชู ุฃุจุฏุงู** - ุงุณุชุฎุฏูู ูู ุงูุณูุฑูุฑ ููุท

### ูู ูู ุขููุ

โ ูุนูุ ูุฃู:

- ููุณุชุฎุฏู ูู API Routes ููุท (server-side)
- ูุง ูุตู ุฅูู ุงููุชุตูุญ (client-side)
- Next.js ูุง ูุดุงุฑู ุงููุชุบูุฑุงุช ุจุฏูู `NEXT_PUBLIC_`

### ูุงุฐุง ูุญุฏุซ ูููุณุชุฎุฏููู ุงูุฌุฏุฏุ

- ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ ุณููุถุงููู ุชููุงุฆูุงู ุฅูู `public.users`
- ุจูุถู trigger ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: `on_auth_user_created`

---

## ๐๏ธ ุญู ุงููุดุงูู

### ุงููุณุชุฎุฏููู ูุง ูุฒุงููู ูุง ูุธูุฑููุ

**ุชุญูู ูู Console:**

```bash
# ูู ุงููุชุตูุญุ ุงุถุบุท F12 ูุงุฐูุจ ุฅูู Console
# ุงุจุญุซ ุนู ุฃุฎุทุงุก ุญูุฑุงุก
```

**ุชุญูู ูู API:**
ุงูุชุญ: https://medad-system.vercel.app/api/admin/users

ูุฌุจ ุฃู ุชุฑู:

```json
{
  "success": true,
  "users": [...],
  "count": 5
}
```

---

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ

- โ [supabase.ts](src/lib/supabase.ts) - ุฃุถุงู `supabaseAdmin`
- โ [route.ts](src/app/api/admin/users/route.ts) - ูุณุชุฎุฏู `supabaseAdmin`
- โ [.env.local.example](.env.local.example) - ููุซูู ุงูููุชุงุญ ุงูุฌุฏูุฏ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 16 ูุจุฑุงูุฑ 2026  
**ุงูุฅุตุฏุงุฑ:** 2.0
