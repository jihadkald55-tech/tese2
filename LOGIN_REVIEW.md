# โ ูุฑุงุฌุนุฉ ูุชุญุณูู ูุธุงู ุชุณุฌูู ุงูุฏุฎูู

## ๐ฏ ูุง ุชู ุฅูุฌุงุฒู

ุชู ูุฑุงุฌุนุฉ ูุชุญุณูู **ูู ุดูุก** ูุชุนูู ุจุชุณุฌูู ุงูุฏุฎูู ูุงููุตุงุฏูุฉ:

---

## ๐ ุงูุชุญุฏูุซุงุช ุงููููุฐุฉ

### 1๏ธโฃ ุตูุญุฉ ูุณูุงู ูููุฉ ุงููุฑูุฑ

**ุงูููู:** `src/app/forgot-password/page.tsx`

#### ูุง ุชู ุชุญุณููู:

โ **ุชูุงูู ูุน Supabase** - ุงุณุชุฎุฏุงู `resetPasswordForEmail()`  
โ **ุฑุณุงุฆู ุฎุทุฃ** - ุนุฑุถ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ  
โ **ุญุงูุงุช ุงูุชุญููู** - ุนุฑุถ Loader ุนูุฏ ุงูุฅุฑุณุงู  
โ **ุงููุถุน ุงููุธูู** - ุฏุนู ูุงูู ูููุถุน ุงููุธูู  
โ **ูุนุงูุฌุฉ ุฃูุถู** - ุชุฌุฑุจุฉ ูุญุณููุฉ ุนูุฏ ุงูุฅุฑุณุงู ุงููุงุฌุญ

**ูุซุงู:**

```typescript
const { error } = await supabase.auth.resetPasswordForEmail(email, {
  redirectTo: `${window.location.origin}/reset-password`,
});
```

---

### 2๏ธโฃ ุตูุญุฉ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ (ุฌุฏูุฏุฉ)

**ุงูููู:** `src/app/reset-password/page.tsx` โจ **ุฌุฏูุฏ**

ูุฐู ุตูุญุฉ ูุงููุฉ ูุฅููุงู ุนูููุฉ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ!

#### ุงููููุฒุงุช:

โ **ุงูุชุญูู ูู ุงูุฑุงุจุท** - ุชุญูู ูู ุตุญุฉ ุฑุงุจุท ุฅุนุงุฏุฉ ุงูุชุนููู  
โ **ุชุบููุฑ ูููุฉ ุงููุฑูุฑ** - ูุงุฌูุฉ ุขููุฉ ูุชุบููุฑ ูููุฉ ุงููุฑูุฑ  
โ **ูุชุทูุจุงุช ูุงุถุญุฉ** - ุนุฑุถ ูุชุทูุจุงุช ูููุฉ ุงููุฑูุฑ ุจุดูู ูุนูุงู  
โ **ุฑุณุงุฆู ูุฌุงุญ** - ุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ูุฅุนุงุฏุฉ ุชูุฌูู ุชููุงุฆูุฉ  
โ **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก** - ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูุณูุงู ูุชุทูุจ

**ุงููุณุงุฑ ุงููุงูู:**

```
1. ุงููุณุชุฎุฏู ูุฏุฎู ุจุฑูุฏู โ ุตูุญุฉ reset-password
2. ูุฃุฎุฐ ุฑุงุจุท ูู ุงูุจุฑูุฏ โ ูููุฑ ุนูู ุงูุฑุงุจุท
3. ูุตู ุฅูู ุตูุญุฉ reset-password
4. ูุฏุฎู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ
5. ุงููุธุงู ูุญูู ูููููู ูุชุณุฌูู ุงูุฏุฎูู
```

---

### 3๏ธโฃ ุชุญุณูู Middleware

**ุงูููู:** `src/middleware.ts`

#### ูุจู ุงูุขู:

- ูุงู ูุนูุฏ ูุชุงุจุฉ headers ููุท
- ูุง ุชูุฌุฏ ุญูุงูุฉ ูููุณุงุฑุงุช

#### ุจุนุฏ ุงูุชุญุณูู:

โ **ุญูุงูุฉ Dashboard** - ููุท ุงููุณุชุฎุฏููู ุงููุตุงุฏููู ูููููู ุงูุฏุฎูู  
โ **ุฅุนุงุฏุฉ ุชูุฌูู ุฐููุฉ** - ูุญูุธ ุงููุณุงุฑ ุงูููุตูุฏ ููุนูุฏ ุงูุชูุฌูู ุจุนุฏ ุงูุชุณุฌูู  
โ **Supabase Auth** - ุชุญูู ูู ุตุญุฉ ุงูุฌูุณุฉ ููุฌููุน  
โ **ููุน ุงููุตูู ุงููุจุงุดุฑ** - ุฅุนุงุฏุฉ ุชูุฌูู ุงููุตุงุฏููู ุจุนูุฏุงู ุนู ุตูุญุงุช ุงูุชุณุฌูู

**ุงูููุณูุฉ:**

```typescript
// ุฅุฐุง ุญุงููุช ุงูุฏุฎูู ูู /dashboard ุจุฏูู ุชุณุฌูู ุฏุฎูู:
GET /dashboard โ REDIRECT /login?redirect=/dashboard

// ุฅุฐุง ุฏุฎูุช ูุนุฏุช ูุตูุญุฉ ุงูุชุณุฌูู:
GET /login (authenticated) โ REDIRECT /dashboard

// ุงูุฌูุณุฉ ููุชููุฉ ุงูุตูุงุญูุฉ:
GET /dashboard (expired) โ REDIRECT /login
```

---

### 4๏ธโฃ ุชุญุณูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู

**ุงูููู:** `src/app/login/page.tsx`

#### ูุง ุชู ุฅุถุงูุชู:

โ **ูุนุงููุฉ ุฅุนุงุฏุฉ ุงูุชูุฌูู** - ููุฑุฃ ูููุน ุงูุฅุนุงุฏุฉ ูู URL  
โ **SuspenseParam** - ุงุณุชุฎุฏุงู `useSearchParams()` ููุญุตูู ุนูู ูุนุงูู redirect  
โ **ุฅุนุงุฏุฉ ุชูุฌูู ุฐููุฉ** - ูููู ุงููุณุชุฎุฏู ููููุงู ุงูููุตูุฏ ุจุนุฏ ุงูุชุณุฌูู

**ูุซุงู ุงูุงุณุชุฎุฏุงู:**

```
// ุงููุณุชุฎุฏู ุฌุงุก ูู dashboard ููู ุบูุฑ ูุตุงุฏู
/login?redirect=/dashboard

// ุจุนุฏ ุงูุชุณุฌููุ ููุชูู ุฅูู:
/dashboard
```

---

## ๐ ูุธุงู ุงููุตุงุฏูุฉ ุงููุงูู

ุงูุขู ูุฏูู ุนูููุฉ ุชุณุฌูู ุฏุฎูู ุขููุฉ ููุงููุฉ:

```
โโโโโโโโโโโโโโโโโโโ
โ  ุชุณุฌูู ุฏุฎูู    โ
โ  login/         โ โ /login?redirect=/dashboard
โโโโโโโโโโฌโโโโโโโโโ
         โ
    โ OR โ
    ุตุญูุญ | ุฎุทุฃ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ   Dashboard     โ   โ ุฅุฐุง ูุงู ุตุญูุญ
โ   /dashboard    โ
โ                 โ
โ  ูุญูู ุจูุงุณุทุฉ   โ
โ  Middleware     โ
โโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโ

ุฅุฐุง ูุณูุช ูููุฉ ุงููุฑูุฑ:

โโโโโโโโโโโโโโโโโโโ
โ ูุณูุงู ูููุฉ ู    โ
โ/forgot-password โ โ ูููุฉ ุงููุฑูุฑ ุงูุญุงููุฉุ
โโโโโโโโโโฌโโโโโโโโโ
         โ
    ุฃุฏุฎู ุจุฑูุฏู
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  ุชุญูู ุงูุฑุณุงูุฉ  โ โ ุงูุชุญ ุงูุจุฑูุฏ
โ  ูู ุงูุจุฑูุฏ       โ
โโโโโโโโโโโโโโโโโโโ

         โ
    ุงููุฑ ุงูุฑุงุจุท
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  ุฅุนุงุฏุฉ ุชุนููู   โ
โ  reset-password โ โ ูููุฉ ูุฑูุฑ ุฌุฏูุฏุฉ
โโโโโโโโโโฌโโโโโโโโโ
         โ
    ุงุญูุธ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  ุณุฌู ุฏุฎูู      โ
โ  login/         โ โ ุจุงููููุฉ ุงูุฌุฏูุฏุฉ
โโโโโโโโโโโโโโโโโโโ
```

---

## ๐ก๏ธ ุงูุญูุงูุฉ ุงููุฑุชุจุทุฉ

### Row Level Security (RLS)

ูู ุฌุฏุงูู Supabase ูุญููุฉ:

- ุงููุณุชุฎุฏู ูุฑู ุจูุงูุงุชู ููุท
- ูุง ูููู ุฑุคูุฉ ุจูุงูุงุช ุงูุขุฎุฑูู

### Password Security

- ูููุงุช ุงููุฑูุฑ ูุดูุฑุฉ ูู Supabase
- ููู ุขูู (HTTPS)
- ุนุฏู ุชุฎุฒูู ูู localStorage

### Session Management

- ุฌูุณุงุช ุขููุฉ ุนุจุฑ Supabase Auth
- ุชูุชูู ุชููุงุฆูุงู
- ูุนุงููุฉ ุงูุฌูุณุฉ ุงูููุชููุฉ

---

## โจ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

| ุงูููุฒุฉ                  | ุงููุงุฆุฏุฉ                       |
| ----------------------- | ----------------------------- |
| ๐ ุฅุนุงุฏุฉ ุงูุชูุฌูู ุงูุฐููุฉ | ุงููุณุชุฎุฏู ููุชูู ููููุงู ุงูููุตูุฏ |
| ๐ก๏ธ ุญูุงูุฉ Dashboard      | ููุท ุงููุตุงุฏููู ูููููู ุงูุฏุฎูู   |
| ๐ง ุฅุนุงุฏุฉ ุชุนููู ุขููุฉ     | ุฑุงุจุท ุฃุญุงุฏู ุงูุงุณุชุฎุฏุงู          |
| โ๏ธ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ      | ุงููุณุชุฎุฏู ูููู ูุง ุญุฏุซ          |
| ๐ ูุถุน ูุธูู             | ุชุฌุฑุจุฉ ูุฑูุญุฉ ููุนูููู           |

---

## ๐ ููุฎุต ุงููููุงุช ุงููุนุฏูุฉ

| ุงูููู                      | ุงูุชุบููุฑุงุช                     | ุงูุญุงูุฉ  |
| -------------------------- | ----------------------------- | ------- |
| `forgot-password/page.tsx` | ุชูุงูู Supabase + ุฑุณุงุฆู ุฎุทุฃ    | โ ูุญุฏุซ |
| `reset-password/page.tsx`  | **ุฌุฏูุฏ ุชูุงูุงู**               | โจ ุฌุฏูุฏ |
| `login/page.tsx`           | ุฅุนุงุฏุฉ ุชูุฌูู ุฐููุฉ              | โ ูุญุฏุซ |
| `middleware.ts`            | ุญูุงูุฉ ุงูุฑูุงุจุท + Supabase Auth | โ ูุญุฏุซ |
| `UserContext.tsx`          | ุจุฏูู ุชุบููุฑ                    | โ ุฌุงูุฒ |

---

## ๐ ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1๏ธโฃ ุงุฎุชุจุงุฑ ุชุณุฌูู ุฏุฎูู ุนุงุฏู

```
1. ุงุฐูุจ ุฅูู /login
2. ุงุณุชุฎุฏู ุจูุงูุงุช ุชุฌุฑูุจูุฉ:
   - ุงูุจุฑูุฏ: student@university.edu
   - ูููุฉ ุงููุฑูุฑ: 123456
3. ูุฌุจ ุฃู ููุชูู ูู /dashboard
```

### 2๏ธโฃ ุงุฎุชุจุงุฑ ุฅุนุงุฏุฉ ุงูุชูุฌูู

```
1. ุงุฐูุจ ูู /dashboard (ุจุฏูู ุชุณุฌูู ุฏุฎูู)
2. ุณูุชู ุงูุชูุฌูู ูู /login?redirect=/dashboard
3. ุณุฌู ุฏุฎูู
4. ุณููุชูู ูุจุงุดุฑุฉ ูู /dashboard (ุจุฏูุงู ูู ุงูุตูุญุฉ ุงูุงูุชุฑุงุถูุฉ)
```

### 3๏ธโฃ ุงุฎุชุจุงุฑ ูุณูุงู ูููุฉ ุงููุฑูุฑ

```
1. ุงุฐูุจ ูู /forgot-password
2. ุฃุฏุฎู ุจุฑูุฏู ุงูุฅููุชุฑููู
3. ุณุชุณุชูุจู ุฑุณุงูุฉ (ูู Supabase)
4. ุงูุชุญ ุงูุฑุณุงูุฉ ูุงุถุบุท ุงูุฑุงุจุท
5. ุณูุฃุฎุฐู ูู /reset-password
6. ุบูุฑ ูููุฉ ุงููุฑูุฑ
7. ุณููุชูู ูู /login ุชููุงุฆูุงู
```

### 4๏ธโฃ ุงุฎุชุจุงุฑ ุญูุงูุฉ ุงูุฑูุงุจุท

```
// ูุญุงููุฉ ุงููุตูู ุจุฏูู ุชุตุฑูุญ:
GET /dashboard (no auth) โ /login

// ูุญุงููุฉ ุชุณุฌูู ุฏุฎูู ูุฑุชูู:
GET /login (authenticated) โ /dashboard

// ุฑุงุจุท ููุชูู:
GET /reset-password (expired) โ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ
```

---

## ๐ ุชูุงุตูู ุชูููุฉ

### Supabase Auth Helpers

ุงูุขู ูุณุชุฎุฏู `auth-helpers-nextjs` ูููุตูู ุงูุขูู:

```typescript
import { createMiddlewareClient } from "@supabase/auth-helpers-nextjs";

const supabase = createMiddlewareClient({ req: request, res });
const {
  data: { session },
} = await supabase.auth.getSession();
```

**ุงูููุงุฆุฏ:**

- โ ุฏุนู ูุงูู ููู Cookies
- โ ุงูุฌูุณุงุช ุชุนูู ุนุจุฑ ุงูุทูุจุงุช
- โ ุฃูุงู ุนุงูู

### ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

ูู ุงูุฃุฎุทุงุก ุงููุญุชููุฉ ูุนุงูุฌุฉ:

```typescript
โ Invalid credentials โ "ุงูุจุฑูุฏ ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ"
โ Email not confirmed โ "ุชุฃูุฏ ูู ุจุฑูุฏู ุฃููุงู"
โ Too many attempts โ "ุชู ุชุฌุงูุฒ ูุญุงููุงุช. ุญุงูู ูุงุญูุงู"
โ Password too short โ "6 ุฃุญุฑู ุนูู ุงูุฃูู"
โ Emails don't match โ "ูููุงุช ุงููุฑูุฑ ุบูุฑ ูุชุทุงุจูุฉ"
```

---

## ๐ฆ ุงููุชุทูุจุงุช

ุชุฃูุฏ ูู ูุฌูุฏ ูุฐู ูู `package.json`:

```json
{
  "dependencies": {
    "@supabase/auth-helpers-nextjs": "^0.8.0",
    "@supabase/supabase-js": "^2.40.0"
  }
}
```

ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ:

```bash
npm install @supabase/auth-helpers-nextjs @supabase/supabase-js
```

---

## โ๏ธ ููุงุท ูููุฉ

### URL ุงูุฅุนุงุฏุฉ

ุชุฃูุฏ ูู ุฃู `reset-password` ููุฌูุฏุฉ ูู Supabase:

```
Supabase Dashboard โ Auth Settings โ Email Templates โ Reset Password Link

ูุฌุจ ุฃู ุชุดูุฑ ุฅูู:
{{ .ConfirmationURL }}
```

### ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ุชุฃูุฏ ูู ูุฌูุฏ ูุฐู ูู `.env.local`:

```env
NEXT_PUBLIC_SUPABASE_URL=your-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-key
```

---

## ๐ ุงูุฎุทูุฉ ุงูุชุงููุฉ

ุงูุขู ููููู:

1. โ ุชุณุฌูู ุฏุฎูู ุขูู
2. โ ุงุณุชุฑุฌุงุน ูููุฉ ุงููุฑูุฑ
3. โ ุญูุงูุฉ ุงูุฑูุงุจุท ุงูุญุณุงุณุฉ
4. โ ุชุฌุฑุจุฉ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

**ูุง ููุง ูู ุชุญุณููุงุช! ๐**

---

_ุขุฎุฑ ุชุญุฏูุซ: 15 ูุจุฑุงูุฑ 2026_
